/*
 * @author      OA Wu <comdan66@gmail.com>
 * @copyright   Copyright (c) 2015 - 2019, Ginkgo
 * @license     http://opensource.org/licenses/MIT  MIT License
 * @link        https://www.ioa.tw/
 */

function u(n,e){if(!(this instanceof u))return new u(n,e);var t=[],l=null,r=n,o=!0===e;this.cancel=function(n){return clearTimeout(l),"function"==typeof n&&n(),this},this.delay=function(n,e){return"function"==typeof n?t.push({time:"number"==typeof e?e:r,func:n})&&this:this},this.run=function(n){if("number"!=typeof n&&(n=0),void 0===t[n]||o)return this;var e=t[n];return l=null===e.time?setTimeout(function(){!1!==e.func.call(this)?this.run(n+1):this.run(t.length)}.bind(this)):setTimeout(function(){!1!==e.func.call(this)?this.run(n+1):this.run(t.length)}.bind(this),e.time),this},this.delay(e,n)}u.all={},u.replace={delay:function(n,e,t){return u.clean(n),"function"==typeof e&&(t=e)&&(e=null),"number"!=typeof e&&(e=null),u.all[n]=u(e,t).run()},animate:function(n,e){return u.clean(n),u.all[n]=u(e)}},u.only={delay:function(n,e,t){return!!u.has(n)||("function"==typeof e&&(t=e)&&(e=null),u.all[n]=u(e,t).run())},animate:function(n,e){return u.all[n]=u(e,u.has(n))}},u.has=function(n){return void 0!==u.all[n]&&u.all[n]instanceof u},u.clean=function(n){return!u.has(n)||(u.all[n].cancel(function(){u.all[n]=null,delete u.all[n]}),!u.has(n))},u.cleanAll=function(){for(i in u.all)u.clean(i)},u.replace.animate("aa").delay(function(){console.error("1")}).delay(function(){console.error("2")},500).delay(function(){return console.error("3"),!1}).delay(function(){console.error("4")}).run(),u.replace.animate("aa").delay(function(){console.error("a-1")}).delay(function(){console.error("a-2")},500).delay(function(){return console.error("a-3"),!1}).delay(function(){console.error("a-4")}).run(),u.cleanAll();